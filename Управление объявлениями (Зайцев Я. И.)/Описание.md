# Рамки: Приложение электронной доски объявлений.

## Cценарий: Управление объявлением

## Уровень: Задача, определенная пользователем.

## Основной исполнитель: Зарегистрированный пользователь.

### Заинтересованные лица и их требования:

- Зарегистрированный пользователь:
  - Хочет быстро и легко создать объявление
  - Хочет редактировать объявление без потери видимости и позиций в поиске (при некритичных объявлениях)
  - Хочет удалять или скрывать объявление
  - Хочет управлять статусом объявления (активное, пауза, продано)

- Администратор:
  - Хочет обеспечить корректную модерацию и соответствие правилам платформы
  - Хочет предотвращать мошенничество и спам

- Компания:
  - Хочет максимизировать публикации качественных объявлений (для увеличения прибыли)
  - Хочет получать комиссию с продаж
  - Хочет иметь аналитические данные по жизненному циклу объявлений (для предсказания трендов)

### Предусловия:

- Пользователь авторизован в системе
- У пользователя есть подтвержденны контактные данные
- Система поддерживает категории, шаблоны форм и правила модерации

### Результаты (Постусловия):

- Объявление добавлено, отредактировано или удалено согласно действиям пользователя
- Пользователь видит актуальный статус объявления и может управлять им дальше (изменять, продлевать, активировать/деактивировать)

### Основной успешный сценарий:

1. Покупатель в профиле выбирает вкладку "Мои объявления"
   - UI отправляет запрос к фасаду для получения существующих объявлений
2. Система получает объявление пользователя
   - Фасад обращается к интерфейсу репозитория объявлений
   - Репозиторий, реализующий данный интерфейс, обращается к базе данных с запросом на выборку
   - База данных возвращает объявления
3. Пользователю отображаются его объявления
   - Система передает полученные данные из фасада в UI 
4. Пользователь нажимает кнопку "Добавить объявление"
   - В UI появляется форма создания объявления
5. После внесения данных пользователь сохраняет объявление
   - UI отправляет заполенные данные в фасад
6. Система сохраняет новое объявление
   - Фасад обращается к интерфейсу репозитория объявлений
   - Репозиторий, реализующий данный интерфейс, обращается к базе данных с запросом на добавление новой записи
   - База данных возвращает добавленное объявление
7. Отправка на модерацию
   - Фасад передает сохранённое объявление в службу уведомлений
   - Служба отправляет уведомление модератору о новом объявлении на проверку
8. Пользователю показывается обновлённый список его объявлений
   - Фасад обращается к интерфейсу репозитория объявлений
   - Репозиторий, реализующий данный интерфейс, обращается к базе данных с запросом на выборку
   - База данных возвращает объявления


### Расширения (альтернативные потоки):

- Пользователь нажимает "Редактировать"
> 1. UI отправляет в фасад ID пользователя, объявления и новые данные
> 2. Фасад обращается к интерфейсу репозитория
> 3. Репозиторий выполняет запрос к базе данных по ID объявления
> 4. База данных возвращает объявление с изменёнными данными
> 5. UI отправляет запрос к фасаду для получения существующих объявлений
> 6. Фасад обращается к интерфейсу репозитория объявлений
> 7. Репозиторий, реализующий данный интерфейс, обращается к базе данных с запросом на выборку
> 8. База данных возвращает список объявлений

- Пользователь нажимает "Удалить"
> 1. UI отправляет в фасад ID пользователя и объявления на удаление
> 2. Фасад обращается к интерфейсу репозитория
> 3. Репозиторий выполняет запрос к базе данных по ID объявления
> 4. База данных удаляет объявление
> 5. UI отправляет запрос к фасаду для получения существующих объявлений
> 6. Фасад обращается к интерфейсу репозитория объявлений
> 7. Репозиторий, реализующий данный интерфейс, обращается к базе данных с запросом на выборку
> 8. База данных возвращает список объявлений

- Пользователь использует поиск объявлений
> 1. UI отправляет введённые поисковые данные в фасад
> 2. Фасад обращается к поискому движку
> 3. Движок делает запрос к базе данных
> 4. База данных возвращает объвления, удовлетворяющиее поисковым критериям
> 5. UI отправляет запрос к фасаду для получения существующих объявлений
> 6. Фасад обращается к интерфейсу репозитория объявлений
> 7. Репозиторий, реализующий данный интерфейс, обращается к базе данных с запросом на выборку
> 8. База данных возвращает список объявлений

### Специальные требования:

- Интуитивная форма создания/редактирования с подсказками, предпросмотром и автосохранением черновика
- Валидация в реальном времени и понятные сообщения об ошибках
- Логирование истории изменений для валидации и модерации.
- Возможность черновиков
- Гибкая политика модерации: авто- и ручная проверка, фильтрация запрещенного контента
- Нотификации о статусе (модерация, опубликовано, отклонено, продлено, продано)
- Доступность интерфейса и поддержка мобильных устройств

### Список технологий и типов данных:

- Данные объявления: заголовок, описание, цена, местоположение, категория, параметры доставки/оплаты, контактные данные, фото/видео, теги, статус, даты
- Модерация: сервис проверки контента (ML/правила), антиспам/антифрод
- Медиа: сервис хранения и оптимизации изображений/видео, генерация превью
- Уведомления о смене статуса
- Аналитика: события CRUD, статусные переходы

### Частота использования:

- Добавление - средняя частота, пиковые нагрузки в сезоны распродаж
- Редактирование - высокая частота в первые дни после публикации
- Удаление - средняя частота по завершении сделки или истечении актуальности

### Открытые вопросы:
- Какие поля должны быть обязательными для разных категорий?
- Какой порог изменений требует повторной модерации?
- Какие лимиты по количеству активных объявлений и обновлений в сутки для одного пользователя?
- Поддерживать ли платные промо-опции (поднятие, закрепление, витрина) и как они взаимодействуют с редактированием?
- Разрешать ли восстановление удаленных объявлений и в течение какого срока?
- Нужны ли шаблоны и массовый импорт (CSV/API) для продавцов с большим инвентарем?
